@model CampusNabber.Models.PostItem

@{
    ViewBag.Title = "Details";
}

<h2>@Html.DisplayFor(model => model.title)</h2>

@section Scripts {
    <script type="text/javascript">
        var mainColor = '@(ViewBag.main_color)';
        var secondaryColor = '@(ViewBag.secondary_color)';

    </script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/SchoolColor.js")"></script>

}

<div class="container">
    <div class="row">
        <hr />

        <div class="col-md-6">
            <dl class="dl-horizontal">

                <dt>
                    Posted By
                </dt>
                <dd>
                    @Html.DisplayFor(model => model.username)
                </dd>
                <dt>
                    School
                </dt>
                <dd>
                    @Html.DisplayFor(model => model.school_name)
                </dd>
                <dt>
                    Date Posted
                </dt>
                <dd>
                    @Html.DisplayFor(model => model.post_date)
                </dd>
                <dt>
                    Price
                </dt>
                <dd>
                    @Html.DisplayFor(model => model.price)
                </dd>
                <dt>
                    Category
                </dt>
                <dd>
                    @Html.DisplayFor(model => model.category)
                </dd>
                <dt>
                    Searchable Tags
                </dt>
                <dd>
                    @Html.DisplayFor(model => model.tags)
                </dd>
                <dt>
                    Description
                </dt>
                <dd>
                    @Html.DisplayFor(model => model.description)
                </dd>

            </dl>
        </div>


        @if (ViewBag.NUMPHOTOS != null)
        {
        <div class="container">
            <div id="myCarousel" class="carousel slide col-md-4" style="width:520px;height:500px" data-ride="carousel">
                <!-- Indicators -->
                <ol class="carousel-indicators">
                    <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                    <li data-target="#myCarousel" data-slide-to="1"></li>
                    <li data-target="#myCarousel" data-slide-to="2"></li>
                </ol>

                <!-- Wrapper for slides
                    We need a default photo for "alt" -->
                @{

                    int numPhotosCheck = ViewBag.NUMPHOTOS;
                    if (numPhotosCheck != 0)
                    {
                        <div class="carousel-inner" role="listbox">
                            <div class="item active">
                                <img src='@ViewBag.AWS_URL' alt="hey we couldn't find this picture" style="width:520px;height:500px">
                            </div>
                            <!--If statement here if there is
                                more than one photo-->
                            @{
                                int numPhotos = ViewBag.NUMPHOTOS;
                                if (numPhotos > 1)
                                {
                                    int skipFirstPhoto = 0;
                                    foreach (var item in Session)
                                    {
                                        if (skipFirstPhoto != 0)
                                        {
                                            var photo = @HttpContext.Current.Session[item.ToString()].ToString();
                                            <div class="item">
                                                <img src=@photo alt="hey we couldn't find this picture" style="width:520px;height:500px">
                                            </div>
                                        }
                                        skipFirstPhoto++;
                                    }
                                }
                                }
                        </div>
                        }
                    }
                    


                <!-- Left and right controls -->
                <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

        </div>
        <br />
        }




        <!--When we start uploading images with PostItems, insert it here!!!-->
        <div class="col-md-6 text-center">
            <img src='@ViewBag.AWS_URL' alt="Post Image" height="300" width="250" />
        </div>

    </div>
    <div class="row">
        <p>
            @Html.ActionLink("Back to List", "MainMarketView", "MarketPlace")

            @if (User.Identity.Name.Equals(Model.username))
            {
                <a class="btn btn-primary pull-right" href=@Url.Action("Edit", "PostItems", new { id = Model.object_id })>Edit Post</a>
            }
            @if (User.IsInRole("Admin"))
            {
                <a class="btn btn-danger pull-right" href="@Url.Action("Delete", "PostItems", new {id = Model.object_id})">Take Down Post</a>
            }
            else
            {
            <a class="btn btn-danger pull-right" href=@Url.Action("Create","Flag", new { postId = Model.object_id, username = Model.username })>
                <span class="glyphicon glyphicon-flag"></span> Report Post
            </a>
            }
        </p>
    </div>
</div>


